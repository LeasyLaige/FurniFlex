<nav class="navbar navbar-expand-lg bg-white navbar-light shadow-sm fixed-top ff-header w-100">
	<div class="container">
		<a class="navbar-brand d-flex align-items-center" routerLink="/">
			<span class="brand-mark rounded me-2"></span>
			<span class="brand-text">FurniFlex</span>
		</a>

		<button class="navbar-toggler" type="button" aria-label="Toggle navigation" (click)="toggleNav()">
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" [class.show]="isNavOpen()">
			<ul class="navbar-nav me-auto mb-2 mb-lg-0 align-items-lg-center">
				<li class="nav-item">
					<a class="nav-link" routerLink="/">Home</a>
				</li>

				<li class="nav-item dropdown position-static" [class.show]="isCategoriesOpen()">
					<a class="nav-link dropdown-toggle" href="#" role="button" (click)="$event.preventDefault(); toggleCategories()" [attr.aria-expanded]="isCategoriesOpen()">Shop</a>
					<div class="dropdown-menu p-3 mega-menu" [class.show]="isCategoriesOpen()">
						<div class="row g-4">
							<div class="col-12 col-md-6 col-lg-3" *ngFor="let cat of categories()">
								<h6 class="text-uppercase small fw-bold mb-2">{{ cat.name }}</h6>
								<ul class="list-unstyled mb-0">
									<li *ngFor="let item of cat.items">
										<a class="dropdown-item py-1" [routerLink]="['/category', cat.name, item]">{{ item }}</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</li>

				<li class="nav-item"><a class="nav-link" routerLink="/collections">Collections</a></li>
				<li class="nav-item"><a class="nav-link" routerLink="/about">About</a></li>
				<li class="nav-item"><a class="nav-link" routerLink="/contact">Contact</a></li>
			</ul>

			<form class="d-flex align-items-center gap-2 ff-search" role="search" (submit)="$event.preventDefault(); submitSearch()">
				<input class="form-control" type="search" placeholder="Search furniture, brands..." name="q"
							 [ngModel]="query()" (ngModelChange)="query.set($event)" />
				<button class="btn btn-primary d-flex align-items-center" type="submit">
					<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
						<path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.415l-3.85-3.85zm-5.242 1.156a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/>
					</svg>
					<span class="d-none d-md-inline ms-2">Search</span>
				</button>
			</form>

			<div class="d-flex align-items-center gap-2 ms-3 ff-icons">
				<!-- Wishlist -->
				<a class="btn btn-icon position-relative" aria-label="Wishlist" routerLink="/wishlist">
					<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<path d="M20.8 4.6a5.5 5.5 0 0 0-7.8 0L12 5.6l-1-1a5.5 5.5 0 0 0-7.8 7.8l1 1L12 22l7.8-8.6 1-1a5.5 5.5 0 0 0 0-7.8z"/>
					</svg>
					<span class="badge rounded-pill text-bg-danger position-absolute top-0 start-100 translate-middle">{{ wishlistCount() }}</span>
				</a>

								<!-- Account -->
								<ng-container *ngIf="!user(); else loggedIn">
									<a class="btn btn-icon" aria-label="Account" routerLink="/account">
											<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
													<path d="M20 21a8 8 0 1 0-16 0"/>
													<circle cx="12" cy="7" r="4"/>
											</svg>
									</a>
								</ng-container>
								<ng-template #loggedIn>
									<div class="dropdown" [class.show]="isAccountOpen()">
										<button class="btn btn-icon dropdown-toggle" aria-expanded="{{isAccountOpen()}}" aria-label="Account Menu" (click)="toggleAccount()" type="button">
											<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
													<path d="M20 21a8 8 0 1 0-16 0"/>
													<circle cx="12" cy="7" r="4"/>
											</svg>
										</button>
										<ul class="dropdown-menu dropdown-menu-end" [class.show]="isAccountOpen()">
											<li class="dropdown-item-text small text-muted">{{ user()?.name }}</li>
											<li><a class="dropdown-item" routerLink="/account" (click)="isAccountOpen.set(false)">My Account</a></li>
											<li><hr class="dropdown-divider"></li>
											<li><button class="dropdown-item" (click)="logout(); isAccountOpen.set(false)">Log out</button></li>
										</ul>
									</div>
								</ng-template>

				<!-- Cart -->
				<a class="btn btn-icon position-relative" aria-label="Cart" routerLink="/cart">
					<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
						<circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
						<path d="M1 1h4l2.68 12.39A2 2 0 0 0 9.63 15H19a2 2 0 0 0 2-1.61l1.38-7.45H6"/>
					</svg>
					<span class="badge rounded-pill text-bg-primary position-absolute top-0 start-100 translate-middle">{{ cartCount() }}</span>
				</a>
			</div>
		</div>
	</div>
	<div class="ff-topbar text-center small text-white">
		Free shipping on orders over $199 · 30-day returns · 24/7 support
	</div>
</nav>
